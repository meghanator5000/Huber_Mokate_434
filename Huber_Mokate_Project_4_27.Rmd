---
title: "Huber_Mokate_Project_4_27"
author: "Meghan Mokate and Jane Huber"
date: "4/21/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overview

Minimum Wage is a piece of federal economic policy that sets a floor for wage work in the United
States. Originally brought into law during the Great Depression in the 1930’s, the aim was to create
“minimum standard of living necessary for health, efficiency and general well-being, without
substantially curtailing employment”. [source]
Ever since its creation, there has been vigorous debate across the US political spectrum as to what the
value of a minimum wage should be or there should be one at all.
As the “Fight for 15” political movement rises to prominence on the national level, some economists
argue that $15/hour simply isn’t ambitious enough or a reflection of the economy as a whole. The
Center for Economic and Policy Research (CEPR) claims, “Until 1968, the minimum wage not only kept
pace with inflation, it rose in step with productivity growth. The logic is straightforward; we expect that
wages in general will rise in step with productivity growth. For workers at the bottom to share in the
overall improvement in society’s living standards, the minimum wage should also rise with productivity.”

(https://cepr.net/this-is-what-minimum-wage-would-be-if-it-kept-pace-with-productivity)
This analysis will examine that claim through our own analysis of the numbers, looking to see what the
value of the minimum wage would be if, from its inception, minimum wage was increased according to
those two variables. Access to data to produce our own analysis is fairly straightforward,
The US Bureau of Labor and Statistics (BLS) has tracked two key productivity measurements since
1948—a raw productivity rate (measuring output per hour) and a multifactor productivity rate
(measuring output per unit of combined inputs) [(https://www.bls.gov/bls/productivity.htm)]. We will be using the raw productivity rate since we were able
to access cleaned data
The value of inflation of the US dollar is important to factor in because it imbeds purchasing power of
the dollar into what the minimum wage includes. For example, a study by Pew Research demonstrates
that the minimum wage in 1973, $4.03/hr, has the same purchasing power of $23.68 in August 2018—
more than three times the actual minimum wage [https://www.pewresearch.org/facttank/2018/08/07/for-most-us-workers-real-wages-have-barely-budged-for-decades/].
Citations: https://cepr.net/this-is-what-minimum-wage-would-be-if-it-kept-pace-with-productivity/
(https://cepr.net/this-is-what-minimum-wage-would-be-if-it-kept-pace-with-productivity/)
https://www.bls.gov/bls/productivity.htm (https://www.bls.gov/bls/productivity.htm)
https://www.pewresearch.org/fact-tank/2018/08/07/for-most-us-workers-real-wages-have-barely-
budged-for-decades (https://www.pewresearch.org/fact-tank/2018/08/07/for-most-us-workers-realwages-have-barely-budged-for-decades) https://www.forbes.com/advisor/personal-finance/minimumwage-debate/ (https://www.forbes.com/advisor/personal-finance/minimum-wage-debate/)
https://democracyjournal.org/magazine/29/minimum-wage-catching-up-to-productivity/
(https://democracyjournal.org/magazine/29/minimum-wage-catching-up-to-productivity/)
https://www.nytimes.com/2020/06/18/business/coronavirus-minimum-wage-increase.html
(https://www.nytimes.com/2020/06/18/business/coronavirus-minimum-wage-increase.html)
https://www.cnn.com/interactive/2019/business/us-minimum-wage-by-year/index.html
(https://www.cnn.com/interactive/2019/business/us-minimum-wage-by-year/index.html)

# Import Libraries

```{r cars}

library(tidyverse) 
library(rvest)
library(janitor)
library(tinytex)
library(haven) # may use for regression / regression line
library(splitstackshape) # for cSplit
library(knitr)
library(blscrapeR) # to complete inflation-related calculations 
```

## Data Gathering, Cleaning, Tidying

```{r pressure, echo=FALSE}
#Here, we gather and combine our datasets from three main sources.
#Source: https://www.epi.org/productivity-pay-gap/
hourly_comp_net_prod_tb <- read_csv("Data_HourlyCompensation_NetProd.csv")

#Source: https://www.dol.gov/agencies/whd/minimum-wage/history/chart#fn4
min_wage_tb <- read_csv("Data_Year_Minwage.csv")

#Combine avg hourly compensation and net productivity datasets
total_minwage_comp_prod <- left_join(hourly_comp_net_prod_tb, min_wage_tb, by="Year")

#Fill in the federal minimum wage value; the original dataset only included information on when a law was passed to increase the federal minimum wage. Therefore, we need to fill in, year-by-year, what that value was.
total_minwage_comp_prod_r <- 
  total_minwage_comp_prod %>%
  fill(`Minimum Wage`, .direction = "down") 
total_minwage_comp_prod_r

# the 1948 and 1949 values of .40 were excluded, so add these in
total_minwage_comp_prod_r$`Minimum Wage`[is.na(total_minwage_comp_prod_r$`Minimum Wage`)] <- .40

#Retrieve data on annual inflation by scraping the USInflationCalculator website.
inflation_data_url <- "https://www.usinflationcalculator.com/inflation/consumer-price-index-and-annual-percent-changes-from-1913-to-2008/"
inflation_source <- inflation_data_url %>%
  html() %>%
  html_nodes(xpath='//*[@id="post-17"]/div/div[1]/table') %>%
  html_table()
inflation_source_1 <- inflation_source[[1]]

#Here, we create an annual inflation dataset by cleaning the data retrieved from the website.
inflation <- inflation_source_1 %>%
  row_to_names(row_number = 2) %>%
  select(1, 14) %>% # changed from column 16
  rename("Annual Inflation" = 3) %>%
  mutate(Year = as.double(Year), `Annual Inflation` = as.double(`Annual Inflation`))
inflation

#Finally, combine all datasets by year to create a master dataset that we will use for our full analysis
master_set <- left_join(total_minwage_comp_prod_r, inflation, by="Year")
master_set

```

## Calculate Values

Convert all Minimum Wage dollar values to 2018 dollars
```{r}
# start by putting our base year 
# $ amount CPI / year_0 CPI



```


Calculate expected minimum wage based off inflation
```{r}
# Change inflation value to a percentage
master_set$ann_inflat <- (master_set$`Annual Inflation`) / 100

# Create a vector to 
master_set$inflat_adj <- vector("numeric", 71)
for (i in seq(nrow(master_set))) {
  if (i == 1) {
    master_set$inflat_adj[i] <- master_set$`Minimum Wage`
  } else {
    master_set$inflat_adj[i] <- (master_set$inflat_adj[i - 1]*master_set$ann_inflat[i]) + master_set$inflat_adj[i-1] } 
}


```


