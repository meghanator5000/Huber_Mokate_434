---
title: "US Economic Productivity and Minimum Wage"
author: "Jane Huber & Meghan Mokate"
date: "5/3/2021"
output:
  html_document: 
    code_folding: hide
---

## Introduction

Minimum Wage is a piece of federal economic policy that sets a floor for wage work in the United States. Originally brought into law during the Great Depression in the 1930’s, the aim was to create “minimum standard of living necessary for health, efficiency and general well-being, without substantially curtailing employment”.

Ever since its creation, there has been vigorous debate across the US political spectrum as to what the value of a minimum wage should be or there should be one at all. As the “Fight for 15” political movement rises to prominence at the national level, some economists argue that $15/hour simply is not ambitious enough or is not a reflection of the economy as a whole. The Center for Economic and Policy Research (CEPR) claims, “Until 1968, the minimum wage not only kept pace with inflation, it rose in step with productivity growth. The logic is straightforward; we expect that wages in general will rise in step with productivity growth. For workers at the bottom to share in the overall improvement in society’s living standards, the minimum wage should also rise with productivity.”

Research Question:

We will examine that claim through our own analysis of the numbers looking to see: 
What are the value of the minimum wage would be if, from its inception, minimum wage was increased according to those two variables? We will also examine the years in which minimum wage changed and consider changes by decade to provide context for past increases. This can be used to inform policymakers of how the perception and treatment of minimum wage has changed over time with hopes of providing more detailed understanding of the current rate's ability or inability to meet the established objectives of minimum wage.
Our scope looks at the years 1948 through 2018 at the federal level. We use Consumer Price Index (CPI) throughout our calculations. The unit of analysis is the minimum wage by year.

## Findings

### Decades:

We find that the proportional minimum wage was increasing steadily from the 1950s to the 1970s, with a big drop off in the 1980s - from an increase of 0.81 in the 70s to 0.08 in the 80s. This recovered a bit in the 1990s and 2000s, with increases of 0.36 and 0.41, respectively. However, the increase still fails to come close to the 1960s or 1970s rates. Using 2018 as the final year of the 2010s decade, since following years are out of our scope, we see that this amount falls to 0, meaning that in the 2010s the raw federal minimum wage did not increase for a decade for the first time in history.

### Wage Calculations:

We calculated two variables: 2018 GDP Adjusted Minimum Wage and Minimum Wage adjusted for Purchasing Power.

The 2018 GDP Adjusted Minimum Wage calculates minimum wage in 2018 dollars adjusted for GDP, and shows an expected adjusted minimum wage value of $39.45 in 2018. 

The value for Minimum Wage adjusted for Purchasing Power demonstrates that in 1940, the raw minimum wage value of $0.40 had a purchasing power of \$4.18 in 2018 dollars.

We compared our calculations to the raw federal minimum wage over the years and found that minimum wage over time has failed to keep pace with the economic factors of productivity and purchasing power. We will further discuss these comparisons and findings when examining our graph and table. 

## Data Gathering, tidying, calculations, and theme creation
```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE)

library(tidyverse) 
library(rvest)
library(janitor)
library(tinytex)
library(knitr)
library(splitstackshape) # for cSplit
library(extrafont)
library(lubridate) # to help clean date representations
library(kableExtra)
library(formattable) # to change value to currency
library(blscrapeR) # for API scraping

```
Click to view data gathering:
```{r gather-data}
# Github links to csv included for ease of downloading

# Net productivity dataset
#Source: https://www.epi.org/productivity-pay-gap/
# https://raw.githubusercontent.com/meghanator5000/Huber_Mokate_434/main/Data_HourlyCompensation_NetProd.csv?token=AOVI43XRHZ2O6BGPLGBLA4LAR5NR2
net_productivity_dataset <- read_csv("Data_HourlyCompensation_NetProd.csv")

net_productivity_dataset <- 
  net_productivity_dataset %>% 
  select(Year, `Net Productivity`) %>% 
  transmute(year = Year,
            net_productivity = `Net Productivity`)

# Raw Minimum Wage dataset
#Source: https://www.dol.gov/agencies/whd/minimum-wage/history/chart#fn4
# https://raw.githubusercontent.com/meghanator5000/Huber_Mokate_434/main/Data_Year_Minwage.csv?token=AOVI43XYGUL7ULFQKX2NWKTAR5NZS
min_wage_dataset <- read_csv("FederalMinimumWage.csv")

min_wage_dataset <- 
  min_wage_dataset %>% 
  transmute(year = as.numeric(format(as.Date(mdy(effective_date)), "%Y")),
            raw_min_wage = 
              as.numeric(str_replace_all(fed_min_wage, "\\$", "")))

# NOTE: At this point, the minimum wage dataset only contains years in which
# the minimum wage was adjusted by Congress. We will address this as we
# combine datasets.

# Inflation dataset

# Get "seriesId" from BLS website.This refers to the CPI for all items
# for urban consumers, which is considered the standard for economic
# analysis.

# bls_seriesid <- "CUSR0000SA0"
# 
# # BLS API only allows for 10 years of data to be gathered at a time.
# # Therefore, calculate the number of iterations through a for loop
# # needed to capture all data.
# 
# num_decades <- round((2018 - 1948) / 10) + 1
# 
# # Set initial values for start and end year. In the for loop, we will update
# # these values after gathering the data.
# start_year <- 1948
# end_year <- 1957
# 
# for (i in 1:num_decades) {
# 
#   if (i != 1) {
# 
#     start_year <- end_year + 1
#     end_year <- start_year + 9
# 
#     if (as.numeric(end_year) > 2018) {
#       #This is the final year that we want in the dataset.
#       end_year <- 2018
#     }
#   }
# 
#   decade_dataset <- bls_api(seriesid = bls_seriesid,
#                        startyear = as.character(start_year),
#                        endyear = as.character(end_year),
#                        annualaverage=TRUE)
#   if (i != 1) {
#     inflation_dataset <- bind_rows(inflation_dataset, decade_dataset)
#   } else {
#     inflation_dataset <- decade_dataset
#   }
# }

# to reduce the number of times we had to run the API, we wrote to a csv and referenced this throughout our testing
# write_csv(inflation_dataset, "Inflation_Dataset")
inflation_dataset <- read_csv("Inflation_Dataset")

# https://raw.githubusercontent.com/meghanator5000/Huber_Mokate_434/main/Inflation_Dataset?token=AOVI43Q5RNTD2MNIFO3IUXDAR5N4E

# The BLS provides us with monthly CPI values for every year since 1948. We 
# need to average these values to create an annual CPI value.

inflation_dataset <- 
  inflation_dataset %>% 
  group_by(year) %>% 
  summarize(annual_avg_cpi = mean(value))


# Presidents dataset

# https://raw.githubusercontent.com/meghanator5000/Dataset-List/master/presidents.csv
presidents <- read_csv('presidents.csv') %>%
  cSplit("President Name,Years In Office,Number,Party", ",") %>% # split values into separate columns
  rename(president = "President Name,Years In Office,Number,Party_1", # rename columns
         years = "President Name,Years In Office,Number,Party_2",
         number = "President Name,Years In Office,Number,Party_3",
         party = "President Name,Years In Office,Number,Party_4") %>%
  separate(years, c("start_year", "end_year"), sep = "-") %>% # separate years values
  mutate(end_year = ifelse(president == "William H. Harrison", 1841, end_year)) %>% # fill in some misc missing values 
  mutate(end_year = ifelse(president == "Donald Trump", 2021, end_year)) %>%
  pivot_longer(cols = c(start_year, end_year), # pivot so that years are a column
               names_to = "start_end",
               values_to = "year",
               values_transform = list("year"=as.numeric)) %>%
  select(1, 5) # select only rows we want

# Combine datasets 

#First, combine inflation and min_wage datasets
main_dataset <- 
  full_join(min_wage_dataset, inflation_dataset)

#Now, add in the net productivity
main_dataset <- 
  full_join(main_dataset, net_productivity_dataset)

```
Click here to view tidying of dataset:
```{r tidy-main_dataset}
# ensure that year is arranged chronologically and fill minimum wage values down so that all years have a value for minimum wage, not just the year it changed
# filter year since our scope is only for 1948 through 2018
main_dataset <- 
  main_dataset %>% 
  arrange(year) %>% 
  fill(raw_min_wage, .direction = "down") %>% 
  filter(year >= 1948)

```
Click to view the productivity multiplier calculation:
```{r calculate-productivity-multiplier}
# We will be using a for loop to calculate this column

# need to create the column with the specified type and length
main_dataset$prod_multiplier <- vector("numeric", nrow(main_dataset))

# loops through the main dataset and takes the difference in percentage year to year, divides this by 100 since it is a percentage, and adds 1, since it is a multiplier
for (i in 1:nrow(main_dataset)) {
  
  main_dataset$prod_multiplier[i] <-  {
    if (i == 1) {
      1
    } 
    else {
      1 + ((main_dataset$net_productivity[i] -
                          main_dataset$net_productivity[i-1]) / 100)
    }
  }
}

```
Click to view the 2018 Minimum Wage Adjusted calculation:
```{r convert-minwage-to-2018-dollars}
main_dataset$min_wage_2018_adjusted <- vector("numeric", nrow(main_dataset))

# pull the value for annual average cpi in 2018 and store it in this variable
cpi_for_2018 <- main_dataset[[71,3]]

# loops through rows in main dataset and annual average cpi to a new variable "cpi_for_year"
# creates new variables for a base that assigns the raw minimum wage to the first row (1948) and the minimum wage adjusted for the above year for every subsequent row 
# creates new variables for inflation rate that uses the formula for inflation - (CPIx+1 – CPIx ) / CPIx - and multiplies this by the base minimum for the 1948 row, and finds the year over year percent increase in CPI through taking CPI per year over prior year average CPI and finding adjusted minimum wage through multiplying this percent by the base year minimum wage

for (i in 1:nrow(main_dataset)) {
  
  cpi_for_year <- main_dataset$annual_avg_cpi[i]

  # Get previous minimum wage value, which we will then multiply
  # by the inflation percentage between the two years.
  base_min_wage_for_year <- ifelse(i == 1,
                                   main_dataset$raw_min_wage[i],
                                   main_dataset$min_wage_2018_adjusted[i-1])
  
  if (i == 1) {
  # We use the formula to get inflation and turn it into a decimal.
  
  inflation_rate <- ((cpi_for_2018 - cpi_for_year) / cpi_for_year)

  main_dataset$min_wage_2018_adjusted[i] <- inflation_rate * base_min_wage_for_year
  
  } else {
  
    perc_cpi_increase_year_over_year <- cpi_for_year /
      main_dataset$annual_avg_cpi[i - 1]
    
    main_dataset$min_wage_2018_adjusted[i] <- perc_cpi_increase_year_over_year *
      base_min_wage_for_year
  
  }
}

```
Click to view the purchasing power calculation:
```{r calculate-purchasing-power}
# calculate purchasing power
main_dataset$cpi_change_from_2018 <- (main_dataset$annual_avg_cpi / cpi_for_2018) * 100
# 1 dollar today = 10 cents in 1948
# money in 1948 had 90% less purchasing power

#applying purchasing power
main_dataset$min_wage_purchasing_power <- (cpi_for_2018 / main_dataset$annual_avg_cpi) * main_dataset$raw_min_wage
# minimum wage was the highest as far as purchasing power goes in the 1970's at ~$10. 

```
Click here to view removal of unnecessary columns:
```{r update-dataset-only-necessary-columns}

# Here, we remove unnecessary columns and pivot longer to facilitate graphing
# our data

main_dataset_final <- 
  main_dataset %>%
  pivot_longer(cols = c(raw_min_wage, 
                        min_wage_2018_adjusted,
                        min_wage_purchasing_power),
               names_to = "Type",
               values_to = "Dollars") %>% 
  select(year, "Type", "Dollars") # only want several columns relevant for the graph

```
Click to view the theme creation:
```{r create-theme}
# 1. Includes the minimal theme included in R
# 2. Assigns the Georgia font to graph text
# 3. Specifies that the title is bold, size 16, and seagreen
# 4. Specifies that the subtitle is italic, size 14, and royalblue4
# 5. Specifies that the axis text is size 12 and navyblue
# 6. Eliminate axis lines and ticks
# 7. Rotate x axis values 90 degrees so that entire value is visible and axis is cleaner
# 8. Specifies that the legend title is bold, size 12, and seagreen
# 9. Specifies that the legend text is size 12 and navyblue

wage_theme <-
  theme_minimal() + 
  theme(
    text = element_text(family = "Georgia"), 
    plot.title = element_text(face = "bold", size = 16, color = "seagreen"), 
    plot.subtitle = element_text(face = "italic", size = 14, color = "royalblue4"), 
    axis.title = element_text(size = 14, face = "bold", color = "seagreen"), 
    axis.text = element_text(size = 12, color = "navyblue"), 
    axis.line = element_blank(), 
    axis.ticks = element_blank(), 
    axis.text.x = element_text(angle = 90), 
    legend.title = element_text(size = 12, face = "bold", color = "seagreen"), 
    legend.text = element_text(size = 12, color = "navyblue")) 
```
Click to view the creation of the column for year change:
```{r add-wage-change data}
# need to create the column with the specified type and length
main_dataset$wage_change <- vector("numeric", nrow(main_dataset))

# loops through rows in main_dataset and returns 0 if they did not change from the previous year (row) and 45 if they did change
for (i in seq(nrow(main_dataset))) {
  if (i == 1) {
    main_dataset$wage_change[i] <- 0
  } else {
    if (main_dataset$raw_min_wage[i] == main_dataset$raw_min_wage[i - 1]) {
    main_dataset$wage_change[i] <- 0 # do not want these values to show up when graphed
    } 
    else { 
    main_dataset$wage_change[i] <- 45 # assign value of 45 so that it will align with our other graph when mapped, since our highest value goes up to about $40, so the height is appropriate for our graph
    }
  }
}

```
## Decades

```{r}
# this portion will look at changes in raw minimum wage from the first year in a decade to the last year in the decade for each decade starting with the 1950s and going through the 2010s, with 2018 as the end value for this decade (though, minimum wage has not changed since 2018)

raw_wage_footnote <- "Raw minimum wage in the first year of the decade"

decades <- main_dataset %>%
  select(year, raw_min_wage) %>% # only need these two columns
  mutate(year = as.character(year)) %>%
  filter(year == "2018" | str_detect(year, "0$") | str_detect(year, "9$") & year != "1949") %>% # only want beginning and end decade years, including 2018 and excluding the 1940s
  mutate(year = str_replace(year, "2018", "2019")) %>% # change 2018 to 2019 so that we can use str formulas more easily
  mutate(decade_change = raw_min_wage - lag(raw_min_wage, default = first(raw_min_wage))) %>% # create calculation to find change in minimum wage over the decade
  mutate(beg_decade_wage = ifelse(!str_detect(year, "0$"), lag(raw_min_wage), 0)) %>% # if the year does not end in 0, take the prior value, this is because when we take percentage changes, we compare to starting value
  filter(str_detect(year, "9$")) %>% # only care about changes for end of decade 
  mutate(decade = str_replace(year, "9$", "0s")) %>% # rename values to embody whole decade
  select(decade, decade_change, beg_decade_wage) # select and order columns

# make the rows currency values for the table
decades$decade_change <- currency(decades$decade_change, digits = 2L)
decades$beg_decade_wage <- currency(decades$beg_decade_wage, digits = 2L)

decades_table <- decades %>%  
  kable(col.names = c("Decade",
                      "Decade Change",
                      "Raw Minimum Wage[note]"), 
      align = "ccc",
      caption = "Raw Minimum Wage Change Each Decade and 2018 value used for end of 2010s decade",
      format.args = list(big.mark = ","),
      digits = c(0, 2, 2)) %>% # specify decimal points
  kable_paper(font_size = 12,       
              html_font = "Georgia",
              full_width = T) %>% # allows for table to print to pdf more cleanly
  kable_styling(latex_options = "striped") %>% 
  row_spec(0, bold = T, color ="seagreen", font_size = 15) %>% #Add styling to header
  column_spec(1, bold = T) %>%
  add_footnote(raw_wage_footnote)
  
decades_table
```

```{r}
decades_graph <- decades %>%
  ggplot() +
  geom_bar(aes(x = decade, y = decade_change), stat = "identity", fill = "darkseagreen") +
  labs(title = "Change in Raw Minimum Wage from \nEnd of Decade to Start of Decade", # title graph
       y = "Raw Minimum Wage Change", # label y axis
       x = "Decade", # label x axis
       caption = "2018 value used for end of 2010s decade") + 
  wage_theme +
  theme(plot.title = element_text(hjust = 0.5)) # center the title
decades_graph # view the graph
```

### Changes by decade:

Through completing this exploratory graph, we can see that the 2000s have the greatest change in minimum wage over the periods for which we have full decades (over a $2.00 change). However, when considered, we recall that this demonstrated dollar change does not account for proportional increases, meaning that a \$0.50 increase in the 1950s is much more significant than in later decades. Therefore, we decide to adjust for proportional dollar changes in our explanatory table and graph, shown below. Though, something that does stand out about this graph is that the 2010s did not have an increase in federal minimum wage at all. 

```{r}
decades_prop <- decades %>%
  mutate(proportional_change = as.numeric(decade_change / beg_decade_wage)) # add proportion column

# make these columns into currency type
decades_prop$decade_change <- currency(decades_prop$decade_change, digits = 2L)
decades_prop$beg_decade_wage <- currency(decades_prop$beg_decade_wage, digits = 2L)

# create footnotes to be added in
changes_raw_wage_footnote <- "Changes shown as a proportion of raw minimum wage the first year of the decade and 2018 value used for end of 2010s decade"
footnotes_decades <- c(raw_wage_footnote,
                       changes_raw_wage_footnote)

decades_table <- decades_prop %>%  
  kable(col.names = c("Decade",
                      "Decade Change",
                      "Raw Minimum Wage[note]",
                      "Raw Minimum Wage Proportional Change[note]"), 
      align = "cccc",
      caption = "Proportional Change in Raw Minimum Wage from \nEnd of Decade to Start of Decade",
      format.args = list(big.mark = ","),
      digits = c(0, 2, 2, 2)) %>% 
  kable_paper(font_size = 12,       
              html_font = "Georgia",
              full_width = T) %>% # allows for table to print to pdf more cleanly
  kable_styling(latex_options = "striped") %>% 
  row_spec(0, bold = T, color ="seagreen", font_size = 15) %>% #Add styling to header
  column_spec(1, bold = T) %>%
  add_footnote(footnotes_decades) 
  
decades_table
```

```{r}
decades__prop_graph <- decades_prop %>%
  ggplot() +
  geom_bar(aes(x = decade, y = proportional_change), stat = "identity", fill = "darkseagreen") +
  labs(title = "Proportional Change in Raw Minimum Wage from \nEnd of Decade to Start of Decade", # title graph
       y = "Raw Minimum Wage Proportional Change", # label y axis
       x = "Decade", # label x axis
       caption = "Changes shown as a proportion of raw minimum wage the first year of the decade and 2018 value used for end of 2010s decade") + 
  wage_theme +
  theme(plot.title = element_text(hjust = 0.5)) # center the title
decades__prop_graph # view the graph

```

### Proportional Changes by Decade:

Here we see a very different story than the disproportional graph. The 1950s through the 1970s saw steadily increasing proportional minimum wage changes, with a steep drop off in the 1980s. This was partially recovered in the 1990s, but continues to remain significantly below proportioned increases of the earlier decades of minimum wage. Still, we can see that minimum wage from 2010 to 2018 remained unchanged - an unprecedented situation.

## Wage calculations

```{r create-graph-comparing-min-wages, include = TRUE}
wage_values_graph <- 
  ggplot() +
    geom_bar(data = main_dataset, aes(x = year, y = wage_change), alpha = .6, stat = "identity", fill = "darkseagreen1", color = "darkseagreen1") + # shows years that minimum wage changed in green with an alpha to make the bars transparent
  geom_path(data = main_dataset_final, aes(x = year, y = Dollars, color = Type), size = 1.5) + # shows values from the "Type" column of raw_min_wage, min_wage_2018_adjusted, and min_wage_purchasing_power
  labs(title = "$ Disparity in Actual and Calculated \nMinimum Wage over Time", # title graph
       y = "Dollars", # label y axis
       x = "Year", # label x axis
       caption = "Year when the federal minimum wage changed shown in green") + # add caption to specify what the bar graph is 
  scale_color_discrete(name="Minimum Wage", # label color legend
    labels=c( # change the legend text values
      "2018 GDP Adjusted", 
      "Purchasing Power",
      "Raw Value")) +
  wage_theme + # add in our theme (created above)
  theme(plot.title = element_text(hjust = 0.5)) # center the title

wage_values_graph # view the graph
```

### 2018 GDP Adjusted Versus Raw Value:

The graph shows the steady shallow slope of the raw value of minimum wage over time, ending in a value of \$7.25 in 2018. 
On the other hand, the 2018 GDP Adjusted line, which calculates minimum wage in 2018 dollars adjusted for GDP, shows a much steeper slope. The slope particularly appears to begin its sharp increase in the late 1970s and really takes off around 1981 (the first year of the Reagan administration), ending with a value of $39.45. The gap between these lines demonstrates the amount that wage has failed to increase proportionately with GDP, or net productivity. In terms of informing policy, a GDP adjusted minimum wage of almost \$40 makes the "Fight for 15" appear much less radical.

### Purchasing Power Versus Raw Value:

The graph also shows what the Purchasing Power of minimum wage was over the years in 2018 values. Since the calculation is based on 2018 values, the Raw Value for minimum wage in 2018 is logically equal to its 2018 purchasing power. Though, when looking back year over year, it is clear that the purchasing power of minimum wage has historically been much higher, with the 1940 value of \$4.18 representing a purchasing power of **over ten times** the minimum wage value. 

These metrics highlight that minimum wage over time has failed to keep pace with the economic factors of productivity and purchasing power. 

### Years with Changes in Federal Minimum Wage:

Another informative component of the graph is the green bars, which represent years when federal minimum wage increased. From this analysis, we can see that the longest periods where minimum wage went unchanged were from 1982-1989 (Reagan), 1997-2007 (Clinton and Bush), and from 2009-present (Obama, Trump, Biden). Further, 1974-1981 had almost annual increases in federal minimum wage. Though the increases do not appear to have kept pace with the increasing GDP those years, the increases prevented the gap from widening as much as it would have if the wage had flat-lined. The context provided from viewing historical increases in minimum wage make it clear that the unchanged federal minimum wage from 2009-2018 (and, indeed, to 2021), is an uncommonly long duration. Further, while raw minimum wage has plateaued, 2018 GDP Adjusted values continue to increase sharply and steadily. 

## Snapshot of Minimum Wage Increases

While reflecting on patterns of minimum wage value and increases, it can be helpful to take a snapshot of how minimum wage looks in years in which Congress voted to increase that value.  Alongside the raw minimum wage value, the purchasing power of minimum wage, and a productivity-increased minimum wage value, we wanted to include which president oversaw the increase in minimum wage and the number of years since the previous change.

We wanted to add these values in context because it allows for observers to see more political context when thinking about minimum wage changes and, in particular, to emphasize the lack of steady and regular increases in the minimum wage in the second half of the 20th Century and the beginning of the 21st Century.

It is exactly this lack of increases in the minimum wage that has contributed to the lessening purchasing power of minimum wage, which contributes to many economic issues in the country such as widening inequality.

Click to view the tidying of the presidents dataset:
```{r adjust-presidents-dataset}
# Add in president data pulled in earlier
# This helps us to provide some analysis of what administrations increased wages for context, referenced in our interpretation of our chart

wage_with_pres <-
  left_join(main_dataset, presidents) %>% 
  fill(president, .direction = "up") %>%  # ensure that all years have president values
  filter(!duplicated(year, fromLast = T))

```
Click here to view the table preparation and creation:
```{r create-table-dataset}
# Create table data; we want to narrow down
table_dataset <- 
  left_join(wage_with_pres, min_wage_dataset) %>% 
  filter(wage_change == 45,
         year >= 1948) %>% 
  select(year,
         president,
         raw_min_wage,
         min_wage_purchasing_power,
         min_wage_2018_adjusted) %>%
  mutate("Number of Years Since Last Change" = year - lag(year, default = first(year)), # calculate how long it has been since the last increase in minimum wage
         year = as.character(year)) 

# Convert all dollar values to currency type
table_dataset$raw_min_wage <- currency(table_dataset$raw_min_wage, digits = 2L)
table_dataset$min_wage_purchasing_power <- currency(table_dataset$min_wage_purchasing_power, digits = 2L)
table_dataset$min_wage_2018_adjusted <- currency(table_dataset$min_wage_2018_adjusted, digits = 2L)

long_gap_min_wage_change <- ifelse(table_dataset$`Number of Years Since Last Change` > 5, "red", "black")

year_footnote <- "Year congress updated minimum wage."
raw_min_wage_footnote <- "Original dollar amounts."
purchasing_power_footnote <- "Equivalent to in 2018 dollars."
gdp_min_wage_footnote <- "Minimum wage if it was adjusted for GDP"
productivity_min_wage_footnote <- "Minimum wage if increased along with productivity."
num_years_since_change_footnote <- "We highlight years where it has been more than 5 years since a minimum wage change."

footnotes <- c(year_footnote,
               raw_min_wage_footnote,
               purchasing_power_footnote,
               gdp_min_wage_footnote,
               num_years_since_change_footnote)

table <- 
  table_dataset %>% 
  kable(col.names = c("Year[note]", 
                    "President",
                    "Raw Minimum Wage[note]", 
                    "Purchasing Power[note]",
                    "2018 GDP Adjusted Minimum Wage[note]",
                    "Number of Years Since Last Change[note]"), 
      align = "cccccc",
      caption = "Minimum Wage",
      format.args = list(big.mark = ","),
      digits = c(0, 2, 2, 2, 2)) %>% 
  kable_paper(font_size = 12,       
              html_font = "Georgia",
              full_width = T) %>% # allows for table to print to pdf more cleanly
  kable_styling(latex_options = "striped") %>% 
  add_footnote(footnotes) %>%
  row_spec(0, bold = T, color ="seagreen", font_size = 15) %>% #Add styling to header
  column_spec(6, color = long_gap_min_wage_change) %>% # change font to red in red years that have not had a minimum wage increase in a long time
  column_spec(1, bold = T) 

table

```

## Conclusion

Current discussions surrounding minimum wage increases are very polarizing, with impassioned beliefs of pros and cons from proponents and opponents of the measure. Key arguments made against raising minimum wage are that the increase could lead to inflation and job losses, and negatively impact businesses. Conversely, proponents raise points about the increased costs of living and claim that the current rate is not sufficient income. 

This short analysis exposes some real issue with the current value of minimum wage in 2021 (which has not changed since 2018), providing further evidence for those arguing that the minimum wage has some serious room to increase given overall economic growth. If a rising tide should lift all boats, it is time for minimum wage to buoy to the surface, and no longer leave those earners behind. 

-------------------------------------------------------------------------------
## Appendix I: Methodology and Data

Our calculations seek to mathematically assess how minimum wage over time has related to important economic factors: purchasing power and worker productivity. In doing this, we can provide color about what how minimum wage has changed contextually from 1940 to 2018. The findings of our calculations are visually presented through the graph, which allows us to easily identify how actual raw minimum wage relates to the identified economic factors year over year.

### Gather Datasets

<li>Data Sources</li>
- Productivity data from: https://www.epi.org/productivity-pay-gap/
  - Note that this data comes from a policy research institute, the Economic Policy Institute, but its source is the Bureau of Labor Statistics (BLS) Labor Productivity and Costs program.
- Minimum wage data from: https://www.dol.gov/agencies/whd/minimum-wage/history/chart#fn4
- CPI data from the Bureau of Labor Statistics that details the annual average CPI for the years in our scope. Data download is made possible via an API.
    - Useful Q & A about what CPI is and how to interpret: https://www.bls.gov/cpi/questions-and-answers.htm#Question_15 </liii>
- Presidents data from: https://raw.githubusercontent.com/meghanator5000/Dataset-List/master/presidents.csv

These source of all of these data are government sources and are therefore considered reliable, save the president's dataset which is reliable since it is easily verifiable. There are no obvious limitations to the data, except that perhaps the productivity data was cleaned by a third party and a mistake could have been made. That said, we have no reason to be directly concerned about that data.

### Clean Data

Guide to key datasets:

1. main_dataset = includes all calculations and multiplies and is un-pivoted (wide)
2. main_dataset_final = includes all calculations and multiplies and is pivoted (long) by dollar value calculations each year
3. wage_values_graph = graphed findings of calcuations
4. table_dataset = dataset adjusted to be presented in the table  
5. table = table for values in years when minimum wage changed

### Calculations

Productivity Multiplier: 
The productivity multiplier plays a very important role in how we understand the value of what minimum wage would be if it rose alongside GDP. 
We calculate the difference in percentage in productivity year to year, divide this by 100 since it is a percentage, and add 1, to make it a multiplier.

Purchasing Power of Minimum Wage: 
Since the minimum wage was implemented to ensure that a reasonable standard of living was sustainable, purchasing power is an important consideration. 
We calculate purchasing power through applying the 2018 CPI over the annual average CPI for each respective year and multiplying this value by the raw minimum wage for the year.

Value of Minimum Wage Factoring in Productivity: 
Calculate the productivity-and-inflation-based minimum wage in 2018 dollars. 
Here, we want to convert all dollar amounts in our dataset to 2018 dollars. 
This will make all the values more readable to our audience. 
This helps us to better understand the raw minimum wage amounts in modern context, and to perform our analysis.
We calculate this using the formula for inflation, (CPIx+1 – CPIx ) / CPIx and multiply this by the base minimum for the 1948 row. We then found the year over year percent increase in CPI through taking CPI per year over prior year average CPI. We calculate adjusted minimum wage by multiplying this percent by the base year minimum wage. 

### Final adjustments to data for graph and table

Since our datasets were relatively clean and tidy, there were not many changes needed to use them for the graph and table that we present.

#### Decades
To create the tables and graphs for decades, we did some calculations to find the change in minimum wage through the decade and add a column. We also added a column for proportional change in minimum wage through the decade. Further, we made sure the data was in the type we wanted (for example, currency), and selected only the columns we wanted to view. 

#### Wage Calculations

Graph Adjustments:
That said, our main_dataset needed to be adjusted by pivoting our value columns so that they could all be presented as lines on the line graph. We kept a version of the main_dataset to show the bars of the years when minimum wage changed, and created a column for this. Other than that, we added in our theme and other graph features to tell the story we wanted.

#### Changes in Minimum Wage

Table Data Adjustments:
We also made some small adjustments to our table, beginning with adding in a column for president in each of the years. We then filter for only years when the wage changed for years after 1948 and select only the five columns we want to show: year, president, raw_min_wage, min_wage_purchasing_power, and min_wage_2018_adjusted. Further, we add a column to calculate how long it has been since the last increase in minimum wage. Lastly, we change year to a character value and dollar columns to currency type.